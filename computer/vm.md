这几天元旦，没干什么正经事，把《深入理解计算机系统》的第九章，虚拟存储器部分看了一部分。

计算机种的存储器是分很多层级的。最快的是CPU中的寄存器，然后是三层高速缓存(L1, L2, L3依次递减)，然后是内存，然后是外存（磁盘，U盘，网络）。上面的层次是下面层次的缓存。也就是说，内存其实是磁盘的高速缓存而已。也就是说计算机没有了内存还是可以运行的，只是比较慢而已。早期的程序都是非存储式程序，都不需要内存。只是x86架构需要用到内存。

而虚拟内存是操作系统对磁盘的抽象，所有磁盘操作都是通过虚拟内存来实现的。不过程序员不用关心虚拟内存的管理，因为操作系统已经帮我们管理了。

物理内存的大小往往比磁盘大小小得多（所以才说内存是磁盘的高速缓存。），所以只能缓存磁盘的一部分。为了加速Cpu的访问，操作系统往往把磁盘分块，为了管理方便块的大小都是一样的。内存缓存的基本单位就是这些块的大小。

物理地址和虚拟地址的映射存放在一个叫做页表的数据结构里面，而之前的块在内存中就称为页。而用来将虚拟内存地址转化成物理内存地址的硬件就叫MMU（存储器管理单元，Memory Management Unit）。

页表是一个数据结构，由一个有效位和一个物理地址组成。如果有效位为1，表示该页已经被缓存，接下去的就是对应的内存的地址。如果有效位为1表示该页没有被缓存，这是操作系统就会交换该页磁盘空间和一个内存页的内存，以便指令执行成功。被交换的内存的页就叫做牺牲页。

《深入理解计算机系统》中虚拟内存钱三部分都和缓存的内容差不多。毕竟内存在现代操作系统中就是当作缓存来用的。

毫无疑问，虚拟内存和x86体系结构是我认为当代计算机最伟大的发明。理解了虚拟内存，对操作系统，对进程线程，对共享库什么的理解肯定会更深刻。加油，虚拟内存是通往牛逼程序员的必经之路。

今天爱拼车宣布在6月1号停止服务。发生在身边的故事，以前还和他们合租一个办公室呢。倪伟伟同学还去他们公司面试过呢。加油，希望以后我也能找到一群志同道合的人，组建自己的团队。

倪伟伟同学想好好学ios，而我是后端程序员，到时候我们可以一起去参加THack，O(^_^)O，可以叫上李旋一起去。在八月份之前，好好看看Linux内核的东西。

===
关于内存这里有一篇比较不错的文章。

自己实现malloc方法。 http://kb.cnblogs.com/page/512454/